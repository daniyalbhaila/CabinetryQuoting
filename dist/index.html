<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bosco Cabinetry | Quote Calculator</title>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="icon" href="/assets/favicon-RZ_LE7Hy.ico">

    <!-- Styles -->

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.468.0/dist/umd/lucide.min.js"></script>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script type="module" crossorigin src="/assets/index-adojlO2M.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-BqEl9Yy4.css">
</head>

<body>
    <!-- Password Protection Modal -->
    <div class="password-modal" id="passwordModal">
        <div class="password-box">
            <h2>Access Required</h2>
            <p>Enter the password to access Bosco Cabinetry Quote Calculator</p>
            <form>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="passwordInput" placeholder="Enter password" autofocus>
                </div>
                <div class="password-error" id="passwordError">Incorrect password. Please try again.</div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem;">Unlock</button>
            </form>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="help-modal" id="helpModal">
        <div class="help-content">
            <div class="help-close">
                <button id="closeHelpBtn">‚úï Close</button>
            </div>

            <h2>How to Use the Quote Calculator</h2>
            <p>Welcome to the Bosco Cabinetry Quote Calculator. This guide will help you create accurate quotes for
                custom cabinetry projects.</p>

            <h3>Getting Started</h3>
            <ol>
                <li><strong>Fill in Client Information</strong> - Add client name, project name, and date in the sidebar
                </li>
                <li><strong>Configure Project Settings</strong> - Set project type, ceiling height, and default carcass
                    supplier</li>
                <li><strong>Adjust Rates (if needed)</strong> - Customize shipping, install, drawer, accessory, markup,
                    and discount rates</li>
                <li><strong>Add Line Items</strong> - Click "Add Item" to create rooms or cabinet sections</li>
                <li><strong>Save Your Work</strong> - Click "Save Quote" in the sidebar to preserve your quote for later
                </li>
            </ol>

            <h3>üìê Adding Line Items</h3>
            <p>Each line item represents a room or cabinet section (e.g., Kitchen, Master Bath, Laundry).</p>
            <h4>Required Inputs:</h4>
            <ul>
                <li><strong>Linear Footage</strong> - Enter LF for Upper, Base, and/or Pantry cabinets</li>
                <li><strong>Finish Type</strong> - Select door finish (PVC, Melamine, Skin, etc.)</li>
                <li><strong>Shaped Doors</strong> - Choose "Yes" if doors have profiles/shaping</li>
                <li><strong>Drawers</strong> - Number of drawer units to include</li>
                <li><strong>Accessories</strong> - Number of special accessories (pull-outs, etc.)</li>
            </ul>

            <h4>Optional Overrides:</h4>
            <ul>
                <li><strong>Ceiling Height</strong> - Override default ceiling height for this room</li>
                <li><strong>Carcass Supplier</strong> - Override default supplier for this room</li>
                <li><strong>Dimensions</strong> - Click "Override dimensions" to customize cabinet heights and depths
                </li>
            </ul>

            <h3>üíæ Saving & Loading Quotes (Cloud Sync)</h3>
            <p><strong>Auto-Drafts:</strong> Your current work is saved locally as a draft automatically.</p>
            <p><strong>Save (Publish):</strong> Click the green "Save" button to save/share with the team.</p>
            <p><strong>Load History:</strong> Click the History (clock) icon to view all shared quotes.</p>
            <p><strong>Start Fresh:</strong> Click "New" to clear the form and start a new quote.</p>

            <div
                style="text-align: center; margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--border);">
                <button class="btn btn-primary" id="closeHelpBtn2">Got It!</button>
            </div>
        </div>
    </div>

    <!-- Global Settings Modal -->
    <div class="config-modal" id="configModal">
        <div class="config-content">
            <div class="config-header">
                <h2>Global Settings</h2>
                <button class="btn btn-secondary" id="closeConfigBtn">‚úï Close</button>
            </div>
            <div class="global-settings-info">
                <i data-lucide="info"></i>
                <p>These are your default values for all quotes. You can override them per-quote or per-room.</p>
            </div>
            <div class="config-tabs">
                <button class="config-tab active" data-tab="rates">Rates</button>
                <button class="config-tab" data-tab="dimensions">Default Dimensions</button>
                <button class="config-tab" data-tab="materials">Materials</button>
            </div>
            <div class="config-tab-content active" id="ratesTab">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Shipping ($/LF CAD)</label>
                        <input type="number" class="form-input config-rate-input" id="shippingRate" value="60">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Install ($/LF CAD)</label>
                        <input type="number" class="form-input config-rate-input" id="installRate" value="100">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Drawer ($ USD)</label>
                        <input type="number" class="form-input config-rate-input" id="drawerRate" value="200">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Accessory ($ USD)</label>
                        <input type="number" class="form-input config-rate-input" id="accessoryRate" value="300">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Markup - Full House (%)</label>
                        <input type="number" class="form-input config-rate-input" id="markupRateFull" value="80"
                            step="0.1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Markup - Single Project (%)</label>
                        <input type="number" class="form-input config-rate-input" id="markupRateSingle" value="90"
                            step="0.1">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Discount (%)</label>
                        <input type="number" class="form-input config-rate-input" id="discountRate" value="50">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">USD to CAD Exchange Rate</label>
                    <input type="number" class="form-input config-rate-input" id="exchangeRate" value="1.42"
                        step="0.01">
                </div>
            </div>
            <div class="config-tab-content" id="dimensionsTab">
                <div class="form-group">
                    <label class="form-label">Upper Cabinet Height</label>
                    <input type="number" class="form-input config-dim-input" id="defaultUpperHt" value="760">
                    <div class="dimension-display" id="upperHtDisplay">760mm / 30"</div>
                </div>
                <div class="form-group">
                    <label class="form-label">Base Cabinet Height</label>
                    <input type="number" class="form-input config-dim-input" id="defaultBaseHt" value="920">
                    <div class="dimension-display" id="baseHtDisplay">920mm / 36"</div>
                </div>
                <div class="divider"></div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Upper Depth</label>
                        <input type="number" class="form-input config-dim-input" id="defaultUpperDp" value="300">
                        <div class="dimension-display">300mm / 12"</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Base Depth</label>
                        <input type="number" class="form-input config-dim-input" id="defaultBaseDp" value="600">
                        <div class="dimension-display">600mm / 24"</div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Pantry Depth</label>
                    <input type="number" class="form-input config-dim-input" id="defaultPantryDp" value="600">
                    <div class="dimension-display">600mm / 24"</div>
                </div>
            </div>
            <div class="config-tab-content" id="materialsTab">
                <h3
                    style="font-size: 1rem; color: var(--accent); margin-bottom: 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">
                    Carcass Suppliers (USD/m¬≤)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Holike Rate</label>
                        <input type="number" class="form-input config-rate-input" id="holikeRate" value="65"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Allure Rate</label>
                        <input type="number" class="form-input config-rate-input" id="allureRate" value="200"
                            step="0.01">
                    </div>
                </div>
                <div class="divider" style="margin: 1.5rem 0;"></div>
                <h3
                    style="font-size: 1rem; color: var(--accent); margin-bottom: 1rem; border-bottom: 1px solid var(--border); padding-bottom: 0.5rem;">
                    Door Finish Rates (USD/m¬≤)</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">PVC Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="pvcUnshaped" value="100"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">PVC Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="pvcShaped" value="200"
                            step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Melamine Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="melamineUnshaped" value="70"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Melamine Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="melamineShaped" value="70"
                            step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Skin Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="skinUnshaped" value="150"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Skin Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="skinShaped" value="150"
                            step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Paint/Lacquer Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="paintLacquerUnshaped" value="170"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Paint/Lacquer Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="paintLacquerShaped" value="200"
                            step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Powder Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="powderUnshaped" value="100"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Powder Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="powderShaped" value="200"
                            step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Veneer Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="veneerUnshaped" value="440"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Veneer Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="veneerShaped" value="440"
                            step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">PET Unshaped</label>
                        <input type="number" class="form-input config-rate-input" id="petUnshaped" value="110"
                            step="0.01">
                    </div>
                    <div class="form-group">
                        <label class="form-label">PET Shaped</label>
                        <input type="number" class="form-input config-rate-input" id="petShaped" value="110"
                            step="0.01">
                    </div>
                </div>
            </div>
            <div class="global-settings-actions">
                <button class="btn btn-secondary" id="resetGlobalConfigBtn">
                    <i data-lucide="rotate-ccw"></i>
                    Reset to Factory Defaults
                </button>
                <button class="btn btn-primary" id="saveGlobalConfigBtn">
                    <i data-lucide="save"></i>
                    Save Global Config
                </button>
            </div>
        </div>
    </div>

    <!-- Breakdown Modal -->
    <div class="breakdown-modal" id="breakdownModal">
        <div class="breakdown-content">
            <div class="breakdown-header">
                <h2>Calculation Breakdown</h2>
                <button class="btn btn-secondary" id="closeBreakdownBtn">‚úï Close</button>
            </div>
            <div class="breakdown-body" id="breakdownBody">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <div class="history-header">
                <h2>Saved Quotes</h2>
                <button class="btn btn-secondary" id="closeHistoryBtn">‚úï Close</button>
            </div>
            <div class="history-body" id="quoteHistory">
                <div class="history-list" id="historyList"></div>
            </div>
        </div>
    </div>

    <!-- Project Details Modal (New) -->
    <div class="project-details-modal" id="projectDetailsModal">
        <div class="project-details-content">
            <div class="project-details-header">
                <h2>Project Details</h2>
                <button class="btn btn-secondary" id="closeProjectDetailsBtn">‚úï Close</button>
            </div>
            <div class="project-details-body">
                <div class="form-group">
                    <label class="form-label">Client Name</label>
                    <input type="text" class="form-input" id="clientName" placeholder="Client Name">
                </div>
                <div class="form-group">
                    <label class="form-label">Project Name</label>
                    <input type="text" class="form-input" id="projectName" placeholder="Project Name">
                </div>
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" class="form-input" id="quoteDate">
                </div>
                <div class="divider"></div>
                <div class="form-group">
                    <label class="form-label">Project Type</label>
                    <select class="form-select" id="projectType">
                        <option value="full">Full House</option>
                        <option value="single">Single Project</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Carcass Supplier</label>
                    <select class="form-select" id="carcassSupplier">
                        <option value="holike">Holike ($65/sqm)</option>
                        <option value="allure">Allure ($200/sqm)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ceiling Height</label>
                    <select class="form-select" id="defaultCeiling">
                        <option value="8">8 ft (2450mm)</option>
                        <option value="9">9 ft (2750mm)</option>
                        <option value="10">10 ft (3050mm)</option>
                        <option value="11">11 ft (3350mm)</option>
                        <option value="12">12 ft (3660mm)</option>
                        <option value="13">13 ft (3960mm)</option>
                    </select>
                </div>
            </div>
            <div class="project-details-footer">
                <button class="btn btn-primary" id="saveProjectDetailsBtn">Done</button>
            </div>
        </div>
    </div>

    <!-- Project Overrides Modal -->
    <div class="project-details-modal" id="projectOverridesModal">
        <div class="project-details-content">
            <div class="project-details-header">
                <h2>Project Overrides</h2>
                <button class="btn btn-secondary" id="closeProjectOverridesBtn">‚úï Close</button>
            </div>
            <div class="project-details-body">
                <div class="global-settings-info">
                    <i data-lucide="info"></i>
                    <p>These settings apply only to this quote, overriding global defaults.</p>
                </div>

                <h3
                    style="font-size: 0.875rem; color: var(--text-secondary); margin: 1rem 0 0.5rem 0; font-weight: 600;">
                    Pricing Adjustments</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Markup (%)</label>
                        <input type="number" class="form-input" id="quoteMarkupRate" placeholder="Global" step="0.1">
                        <div class="setting-source" id="markupSource">Global: 80%</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Discount (%)</label>
                        <input type="number" class="form-input" id="quoteDiscountRate" placeholder="Global" step="0.1">
                        <div class="setting-source" id="discountSource">Global: 50%</div>
                    </div>
                </div>

                <h3
                    style="font-size: 0.875rem; color: var(--text-secondary); margin: 1rem 0 0.5rem 0; font-weight: 600;">
                    Custom Rates</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Shipping ($/LF)</label>
                        <input type="number" class="form-input" id="quoteShippingRate" placeholder="Global" step="0.01">
                        <div class="setting-source" id="shippingSource">Global: 60</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Install ($/LF)</label>
                        <input type="number" class="form-input" id="quoteInstallRate" placeholder="Global" step="0.01">
                        <div class="setting-source" id="installSource">Global: 100</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Drawer ($/unit)</label>
                        <input type="number" class="form-input" id="quoteDrawerRate" placeholder="Global" step="0.01">
                        <div class="setting-source" id="drawerSource">Global: 200</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Accessory ($/unit)</label>
                        <input type="number" class="form-input" id="quoteAccessoryRate" placeholder="Global"
                            step="0.01">
                        <div class="setting-source" id="accessorySource">Global: 300</div>
                    </div>
                </div>

                <h3
                    style="font-size: 0.875rem; color: var(--text-secondary); margin: 1rem 0 0.5rem 0; font-weight: 600;">
                    Custom Dimensions</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Upper Height (mm)</label>
                        <input type="number" class="form-input" id="quoteDefaultUpperHt" placeholder="Global">
                        <div class="setting-source" id="upperHtSource">Global: 760</div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Base Height (mm)</label>
                        <input type="number" class="form-input" id="quoteDefaultBaseHt" placeholder="Global">
                        <div class="setting-source" id="baseHtSource">Global: 920</div>
                    </div>
                </div>

                <div class="divider"></div>
                <button class="btn btn-sm btn-secondary" id="resetQuoteOverridesBtn" style="width: 100%;">
                    <i data-lucide="rotate-ccw"></i>
                    Reset to Global Defaults
                </button>
            </div>
            <div class="project-details-footer">
                <button class="btn btn-primary" id="saveProjectOverridesBtn">Done</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <img src="/assets/Logo-Light-By9bl_u7.svg" alt="Bosco Cabinetry" class="logo-img">
            </div>
            <div class="header-actions">

                <button class="btn btn-icon" id="showHistoryBtn" title="Saved Quotes">
                    <i data-lucide="history"></i>
                </button>
                <button class="btn btn-icon" id="showConfigBtn" title="Global Settings">
                    <i data-lucide="settings"></i>
                </button>
                <button class="btn btn-icon" id="showHelpBtn" title="Help">
                    <i data-lucide="circle-help"></i>
                </button>
                <button class="btn btn-icon" id="logoutBtn" title="Logout">
                    <i data-lucide="log-out"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-group">
                <div class="project-summary-card" id="projectSummaryCard">
                    <div class="summary-header">
                        <span class="summary-label">Project</span>
                        <button class="btn-icon-sm" id="editProjectDetailsBtn" title="Edit Details">
                            <i data-lucide="file-pen"></i>
                        </button>
                    </div>
                    <div class="summary-info">
                        <h3 id="summaryClientName" class="summary-client">Client Name</h3>
                        <p id="summaryProjectName" class="summary-project">Project Name</p>
                        <div class="summary-meta-row">
                            <span id="summaryDate" class="summary-date">Date</span>
                            <span class="summary-divider">‚Ä¢</span>
                            <span id="summaryType" class="summary-type">Full House</span>
                        </div>
                    </div>
                </div>

                <!-- Project Overrides Button (Attached) -->
                <button class="btn btn-secondary" id="showProjectOverridesBtn"
                    style="width: 100%; justify-content: space-between;">
                    <span style="display: flex; align-items: center; gap: 0.5rem;">
                        <i data-lucide="sliders"></i>
                        Overrides
                    </span>
                    <span class="quote-settings-badge" id="sidebarOverridesBadge">Global</span>
                </button>
            </div>

            <!-- Quote Actions Card -->
            <div class="card sidebar-actions-card">
                <div class="sidebar-total-section">
                    <span class="sidebar-total-label">Quote Total</span>
                    <div class="sidebar-total-value" id="headerTotal">$0.00</div>
                </div>
                <div class="sidebar-actions-grid">
                    <button class="btn btn-secondary flex-1" id="newQuoteBtn">
                        <i data-lucide="file-plus"></i>
                        New
                    </button>
                    <button class="btn btn-success flex-1" id="saveQuoteBtn">
                        <i data-lucide="cloud-upload"></i>
                        Save
                    </button>
                    <button class="btn btn-icon btn-secondary" id="revertQuoteBtn" style="display: none;"
                        title="Discard">
                        <i data-lucide="rotate-ccw"></i>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <div class="content">
            <div class="items-header">
                <h1>Line Items</h1>
                <div class="items-header-actions">

                    <button class="btn btn-primary" id="addLineItemBtn">
                        <i data-lucide="plus"></i>
                        Add Item
                    </button>
                </div>
            </div>

            <!-- Line Items Container -->
            <div id="lineItemsContainer"></div>

            <!-- Quote Summary -->
            <div class="quote-summary" id="quoteSummary" style="display: none;">
                <div class="quote-summary-header">
                    <h2>Quote Summary</h2>
                    <span id="totalLF">0 LF Total</span>
                </div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <div class="summary-item-label">Cabinetry</div>
                        <div class="summary-item-value" id="totalCabinetry">$0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-item-label">Shipping</div>
                        <div class="summary-item-value" id="totalShipping">$0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-item-label">Install</div>
                        <div class="summary-item-value" id="totalInstall">$0</div>
                    </div>
                    <div class="summary-item">
                        <div class="summary-item-label">Subtotal</div>
                        <div class="summary-item-value" id="totalSubtotal">$0</div>
                    </div>
                </div>
                <div class="quote-total">
                    <div class="quote-total-label">Grand Total</div>
                    <div class="quote-total-value" id="grandTotal">$0.00</div>
                </div>
            </div>
        </div>
    </main>

    <!-- Application Script -->
</body>

</html>